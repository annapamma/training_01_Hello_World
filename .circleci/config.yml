version: 2.1

# PR on branch_a waits
# branch_a creates branch_a_e2e_tests and triggers pipeline with api on branch_a_e2e_tests
# branch_a_e2e_tests pipeline runs
# This way the pipeline is not triggered on branch_b

jobs:
  build:
    docker:
      - image: node:9.6.1
    steps:
      - checkout
      - run: echo "hello world"
      - run: git checkout -b "e2e_tests_${CIRCLE_SHA1}"
      - run: git push -u origin "e2e_tests_${CIRCLE_SHA1}"
  other-job-1:
    docker:
      - image: node:9.6.1
    steps:
      - run: echo "YES I RAN"

workflows:
  build-wf:
    jobs:
      - build:
          filters:
            branches:
              ignore:
                - /e2e_tests-.*/
  other-wf:
      jobs:
        - other-job-1:
            filters:
              branches:
                only:
                  - /e2e_tests-.*/
